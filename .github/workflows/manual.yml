name: SSH into EC2 instance
on:
  push:
jobs:
  ssh:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    - name: Set up SSH key
      run: |
        mkdir -p ~/.ssh
        cd ~/.ssh
        echo "${{ secrets.BASTION_HOST_SSH_KEY }}" >> zaproxy-report-generator.pem
        chmod 600 zaproxy-report-generator.pem
    - name: Get GitHub Actions IP address
      run: curl https://api.github.com/meta | grep actions
    - name: SSH into EC2 instance
      run: ssh -i zaproxy-report-generator.pem kali@34.201.101.99 "ls /tmp/zaproxy"
